import{a as h}from"./index-t--hEgTQ.js";import{S as v}from"./sweetalert2.esm.all-89IKscqO.js";document.addEventListener("DOMContentLoaded",function(){const x=document.getElementById("form-nickname"),s=document.getElementById("nickname"),n=document.getElementById("nickname-feedback"),k=document.getElementById("webhook"),g=document.getElementById("webhook-feedback"),C=document.getElementById("form-senha"),u=document.getElementById("senha_atual"),c=document.getElementById("nova_senha"),m=document.getElementById("nova_senha_confirmation"),d=document.getElementById("erro-senha-atual"),o=document.getElementById("erro-nova-senha"),a=document.getElementById("erro-confirmacao"),p=document.querySelector('input[name="_token"]').value;let E;s&&s.addEventListener("input",function(){clearTimeout(E);const t=s.value.trim();if(t===""){n.textContent="O nickname é obrigatório.";return}if(!/^[a-zA-Z0-9_-]+$/.test(t)){n.textContent="Permitido apenas letras, números, traço e underline.";return}E=setTimeout(()=>{h.get("/usuario/verificar-nickname",{params:{nickname:t}}).then(e=>{e.data.disponivel?n.textContent="":n.textContent="Este nickname já está em uso."})},400)}),x&&x.addEventListener("submit",function(t){t.preventDefault();const e=s.value.trim(),r=k.value.trim();if(n.textContent="",g.textContent="",e===""){n.textContent="O nickname é obrigatório.";return}if(!/^[a-zA-Z0-9_-]+$/.test(e)){n.textContent="Permitido apenas letras, números, traço e underline.";return}n.textContent===""&&h.post("/usuario/alterar-perfil",{nickname:e,webhook:r},{headers:{"X-CSRF-TOKEN":p}}).then(()=>{v.fire({icon:"success",title:"Dados atualizados com sucesso",confirmButtonText:"OK"}).then(()=>location.reload())})}),u.addEventListener("input",()=>{u.value.trim()!==""&&(d.textContent="")}),c.addEventListener("input",()=>{const t=c.value.trim(),e=m.value.trim();t!==""&&(o.textContent=""),t.length>=6&&(o.textContent=""),e!==""&&t===e&&(a.textContent="")}),m.addEventListener("input",()=>{const t=c.value.trim(),e=m.value.trim();e!==""&&(a.textContent=""),t===e&&(a.textContent="")}),C&&C.addEventListener("submit",function(t){t.preventDefault();const e=u.value.trim(),r=c.value.trim(),l=m.value.trim();d.textContent="",o.textContent="",a.textContent="";let i=!1;e===""&&(d.textContent="Este campo é requerido.",i=!0),r===""?(o.textContent="Este campo é requerido.",i=!0):r.length<6&&(o.textContent="A nova senha deve ter no mínimo 6 caracteres.",i=!0),l===""?(a.textContent="Este campo é requerido.",i=!0):r!==l&&(a.textContent="As senhas não coincidem.",i=!0),!i&&h.post("/usuario/alterar-senha",{senha_atual:e,nova_senha:r,nova_senha_confirmation:l},{headers:{"X-CSRF-TOKEN":p}}).then(()=>{v.fire({icon:"success",title:"Senha alterada com sucesso",confirmButtonText:"OK"}).then(()=>location.reload())}).catch(f=>{f.response&&f.response.status===403&&f.response.data.erro==="Senha atual incorreta"?v.fire({icon:"error",title:"Senha atual incorreta",confirmButtonText:"OK"}):o.textContent="Erro ao alterar senha."})})});
