import{S as c}from"./sweetalert2.esm.all-89IKscqO.js";import{a as d}from"./index-t--hEgTQ.js";document.addEventListener("DOMContentLoaded",()=>{const r=document.getElementById("btn-vincular"),e=document.getElementById("fechar-modal-vincular"),t=document.getElementById("modal-vincular");r&&e&&t&&(r.addEventListener("click",()=>{t.classList.remove("hidden")}),e.addEventListener("click",()=>{t.classList.add("hidden")}),t.addEventListener("click",i=>{i.target===t&&t.classList.add("hidden")}))});document.addEventListener("DOMContentLoaded",()=>{const r=document.getElementById("form-editar-conta"),e=document.getElementById("email_nike"),t=e.dataset.id,i=document.querySelector('meta[name="csrf-token"]').getAttribute("content");let n=!0,s=null;const l=o=>{let a=document.getElementById("email-error");a||(a=document.createElement("span"),a.id="email-error",a.className="text-sm text-red-500 mt-1 block",e.insertAdjacentElement("afterend",a)),a.textContent=o,e.classList.add("border-red-500")},m=()=>{const o=document.getElementById("email-error");o&&o.remove(),e.classList.remove("border-red-500")},u=async o=>{if(!o){n=!1,m();return}try{(await d.post("/contas/verificar",{email_nike:o,id:t})).data.exists?(n=!1,l("E-mail já cadastrado.")):(n=!0,m())}catch{n=!1,c.fire("Erro","Não foi possível validar o e-mail.","error")}};e.addEventListener("input",()=>{clearTimeout(s),s=setTimeout(()=>{u(e.value.trim())},400)}),r.addEventListener("submit",async o=>{var f,E;o.preventDefault();const a=e.value.trim();if(await u(a),!a||!n){l("E-mail inválido ou já cadastrado.");return}try{await d.put(`/contas/atualizar/${t}`,{email_nike:a,sincronizado:null},{headers:{"X-CSRF-TOKEN":i}}),await c.fire("Sucesso","Conta atualizada com sucesso.","success"),location.reload()}catch(v){c.fire("Erro",((E=(f=v.response)==null?void 0:f.data)==null?void 0:E.message)||"Erro ao atualizar a conta.","error")}})});document.querySelectorAll(".remover-cartao").forEach(r=>{r.addEventListener("click",async()=>{const e=r.dataset.conta,t=r.dataset.cartao,i=document.querySelector('meta[name="csrf-token"]').getAttribute("content");if((await c.fire({title:"Remover cartão?",text:"Esta ação não pode ser desfeita.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#78c676",cancelButtonColor:"#d33",confirmButtonText:"Sim, remover",cancelButtonText:"Cancelar"})).isConfirmed)try{await d.delete(`/contas/${e}/cartao/${t}`,{headers:{"X-CSRF-TOKEN":i}}),await c.fire("Removido","Cartão desvinculado com sucesso.","success"),location.reload()}catch{c.fire("Erro","Não foi possível remover o cartão.","error")}})});
